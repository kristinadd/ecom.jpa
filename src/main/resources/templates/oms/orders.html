<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/head :: common-head('Order Management System', true)}">
</head>

<body>
    <!-- Header -->
    <div class="admin-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <a href="/ecom/admin/" class="admin-brand" style="text-decoration: none; color: inherit;">
                        <i class="bi bi-shield-check me-2"></i>
                        Admin Console
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Orders Table -->
        <div class="table-container orders-table-container">
            <!-- Table with Orders -->
            <div th:if="${orders.size() > 0}">
                <table class="table table-hover mb-0">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Date</th>
                            <th>Description</th>
                            <th>Total</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="order : ${orders}">
                            <td>
                                <span class="fw-semibold" th:text="${order.id}">Order ID</span>
                            </td>
                            <td>
                                <div th:text="${#temporals.format(order.date, 'yyyy-MM-dd')}">Date</div>
                                <small class="text-muted" th:text="${#temporals.format(order.date, 'HH:mm')}">Time</small>
                            </td>
                            <td>
                                <div class="fw-semibold" th:text="${order.description}">Description</div>
                            </td>
                            <td>
                                <span class="fw-semibold">$<span th:text="${#numbers.formatDecimal(order.total, 1, 2)}">0.00</span></span>
                            </td>
                            <td>
                                <a th:href="@{{id}(id=${order.id})}" class="action-btn btn-view" title="View">
                                    <i class="bi bi-eye"></i>
                                </a>
                                <a th:href="@{update/{id}(id=${order.id})}" class="action-btn btn-edit" title="Edit">
                                    <i class="bi bi-pencil"></i>
                                </a>
                                <button class="action-btn btn-delete" title="Delete"
                                        th:data-order-id="${order.id}" onclick="deleteOrder(this.dataset.orderId)">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Empty State -->
            <div th:if="${orders.size() == 0}" class="empty-state">
                <i class="bi bi-receipt" style="font-size: 3rem; color: #cbd5e1;"></i>
                <h3>No Orders Found</h3>
                <p>No orders have been placed yet.</p>
                <a href="/ecom/admin/" class="btn btn-admin">
                    <i class="bi bi-arrow-left me-2"></i>Back to Admin Console
                </a>
            </div>
        </div>
    </div>

    <!-- Footer Spacing -->
    <div style="height: 3rem;"></div>

    <!-- Scripts -->
    <th:block th:replace="~{fragments/head :: common-scripts}"></th:block>
    
    <script>
        // Delete order function
        function deleteOrder(id) {
            if (confirm('Are you sure you want to delete this order?')) {
                // Create and submit a form to delete the order
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = `delete/${id}`;
                document.body.appendChild(form);
                form.submit();
            }
        }
    </script>
</body>
</html>
